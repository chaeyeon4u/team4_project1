<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mycompany.webapp.dao.CartDao">

	<resultMap type="productCommon" id="productCommonMap">
		<id property="id" column="pcommonId"/>
		<result property="name" column="productName"/>
		<result property="note" column="note"/>
		<result property="brandNo" column="brand_no"/>
	</resultMap>
	
	<resultMap type="productColor" id="productColorMap">
		<id property="id" column="pcolorId"/>
		<result property="img1" column="img1"/>
		<result property="img2" column="img2"/>
		<result property="img3" column="img3"/>
		<result property="colorImg" column="color_img"/>
		<result property="productCommonId" column="product_common_id"/>
		<result property="colorCode" column="color_code"/>
		<result property="price" column="price"/>
	</resultMap>
	
	<resultMap type="productStock" id="productStockMap">
		<id property="id" column="id"/>
		<result property="productColorId" column="product_color_id"/>
		<result property="sizeCode" column="size_code"/>
		<result property="stock" column="stock"/>
	</resultMap>

	<resultMap type="brand" id="brandMap">
		<id property="no" column="no"/>
		<result property="name" column="brandName"/>
	</resultMap>
	
	<resultMap type="com.mycompany.webapp.dto.Product" id="productMap">
		<collection property="productCommon" resultMap="productCommonMap"/>
		<collection property="productColor" resultMap="productColorMap"/>
		<collection property="productStock" resultMap="productStockMap"/>
		<collection property="brand" resultMap="brandMap"/>
<!-- 		<collection property="sizes" column="sizes" ofType=""> -->
		
<!-- 		</collection> -->
	</resultMap>
	
	<!-- 카트 안의 리스트 출력하기 -->
	<select id="selectList" parameterType="String" resultMap="productMap">
		select product_common.id as pcommonId, cart.count, brand.name as brandName, product_common.name as productName,
				product_stock.size_code, product_color.color_code,img1, product_color.color_img, price
			from cart, product_common, product_color, brand, product_stock
			where cart.member_id = #{mid}
	        and cart.product_stock_id =product_stock.id
	        and product_stock.product_color_id = product_color.id
	        and product_common.id = product_color.product_common_id
	        and product_common.brand_no = brand.no
	</select>
	
	<!-- 상품의 색상 리스트 출력하기 -->
	<select id="selectColors" parameterType="String" resultType="com.mycompany.webapp.dto.Color">
		select distinct color_code, color_img
			from product_common, product_color, product_stock
			where product_common.id = #{pcommonId}
			and product_color.product_common_id = product_common.id
			and product_stock.product_color_id = product_color.id
	</select>
	<!-- 상품의 사이즈 리스트 출력하기 -->
	<select id="selectSizes" parameterType="String" resultType="com.mycompany.webapp.dto.Size">
		select distinct size_code
			from product_common, product_color, product_stock
			where product_common.id = 'MM2B9KTO061HOH'
			and product_color.product_common_id = product_common.id
			and product_stock.product_color_id = product_color.id
	</select>
</mapper>